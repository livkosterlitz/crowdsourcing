geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2')+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2',
breaks = c(0.25, 4),
labels = c("0", "4"))+
scale_y_continuous(trans = 'log2')+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2',
breaks = c(0.25, 4),
labels = c("0", "4"))+)+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2',
breaks = c(0.25, 4),
labels = c("0", "4"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2',
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2',
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2',
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = (min(mean_MIC), max(mean_MIC)),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = (-50, 1024),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
c
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = c(-50, 1024),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = c(-50, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2',
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = c(-50, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = c(0, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = c(0.00001, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = c(-inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2')+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('outcome frequency') +
xlab('misalignment score')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")+
facet_wrap(~Species)
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Shorthand), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Shorthand), width=0) +
geom_point(aes(color = Shorthand))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")+
facet_wrap(~Species)
# colors ####
red_Ec_color <- rgb(255, 48, 48, maxColorValue = 255)
blue_Kp_color <- rgb(0, 0, 238, maxColorValue = 255)
yellow_Se_color <- rgb(242, 184, 0, maxColorValue = 255)
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Species), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Species), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")+
facet_wrap(~Species) +
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Species), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Species), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, group = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Species), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Species), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x, color = 'black')+
stat_cor(method = "pearson")+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, group = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Species), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Species), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson")+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, color = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC, color = Species), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode, color = Species), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson")+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))
theme_set(theme_cowplot() +
theme(
text = element_text(size = 9),
axis.title = element_text(size = 9),
axis.text = element_text(size = 7),
legend.title = element_text(size = 9),
legend.text = element_text(size = 9),
plot.title = element_text(size = 9),
plot.subtitle = element_text(size = 9),
plot.caption = element_text(size = 9),
strip.text = element_text(size = 9)
)
)
ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, color = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson")+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))
Fig <- ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, color = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson")+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))
gFig <- set_panel_size(Fig, width  = unit(assembly, "in"), height = unit(p_height, "in"))
# assembly ####
p_width = 4
p_height = 4
library(egg)
# assembly ####
p_width = 4
p_height = 4
gFig <- set_panel_size(Fig, width  = unit(assembly, "in"), height = unit(p_height, "in"))
save_plot("SI_Fig2.pdf", plot = gFig, base_width = 5, base_height = 5)
gFig <- set_panel_size(Fig, width  = unit(assembly, "in"), height = unit(p_height, "in"))
gFig
gFig <- set_panel_size(Fig, width  = unit(p_width, "in"), height = unit(p_height, "in"))
gFig
save_plot("SI_Fig2.pdf", plot = gFig, base_width = 5, base_height = 5)
# assembly ####
p_width = 3
p_height = 3
gFig <- set_panel_size(Fig, width  = unit(p_width, "in"), height = unit(p_height, "in"))
save_plot("SI_Fig2.pdf", plot = gFig, base_width = 5, base_height = 5)
Fig <- ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, color = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson", size = 9)+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))+
guides(color = FALSE)
Fig
# packages ####
library(tidyverse)
library(ggpubr)
library(cowplot)
library(egg)
theme_set(theme_cowplot() +
theme(
text = element_text(size = 9),
axis.title = element_text(size = 9),
axis.text = element_text(size = 7),
legend.title = element_text(size = 9),
legend.text = element_text(size = 9),
plot.title = element_text(size = 9),
plot.subtitle = element_text(size = 9),
plot.caption = element_text(size = 9),
strip.text = element_text(size = 9)
)
)
# colors ####
red_Ec_color <- rgb(255, 48, 48, maxColorValue = 255)
blue_Kp_color <- rgb(0, 0, 238, maxColorValue = 255)
yellow_Se_color <- rgb(242, 184, 0, maxColorValue = 255)
# load data ####
MIC_df <- read.csv("data/MIC_data.csv")
barcode_df <- read.csv("data/MIC_simulation_file_3barcodes.csv")
# MIC analysis
MIC <- MIC_df %>%
group_by(Species, Shorthand) %>%
filter(!(is.na(MIC))) %>%
summarise(N = n(),
mean_MIC = mean(MIC),
se_MIC = sd(MIC)/sqrt(N))%>%
select(-N)
# Barcode analysis
barcode <- barcode_df %>%
select(Species, Shorthand, fit.1, fit.2) %>%
pivot_longer(cols = c(fit.1, fit.2), names_to = 'replicate') %>%
group_by(Species, Shorthand) %>%
summarise(N = n(),
mean_barcode = mean(value),
se_barcode = sd(value)/sqrt(N)) %>%
select(-N)
total <- left_join(barcode, MIC)
Fig <- ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, color = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson", size = 9)+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))+
guides(color = FALSE)
# assembly ####
p_width = 3
p_height = 3
gFig <- set_panel_size(Fig, width  = unit(p_width, "in"), height = unit(p_height, "in"))
save_plot("SI_Fig2.pdf", plot = gFig, base_width = 5, base_height = 5)
Fig <- ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, color = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode), width=0) +
geom_point(aes(color = Species))+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson", size = 2)+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))+
guides(color = FALSE)
# assembly ####
p_width = 3
p_height = 3
gFig <- set_panel_size(Fig, width  = unit(p_width, "in"), height = unit(p_height, "in"))
save_plot("SI_Fig2.pdf", plot = gFig, base_width = 5, base_height = 5)
Fig <- ggplot(data = total, aes(x = mean_barcode, y = mean_MIC, color = Species)) +
geom_errorbar(aes(ymin=mean_MIC-se_MIC, ymax=mean_MIC+se_MIC), width=0) +
geom_errorbar(aes(xmin=mean_barcode-se_barcode, xmax=mean_barcode+se_barcode), width=0) +
geom_point(aes(color = Species), size = 1)+
scale_x_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
scale_y_continuous(trans = 'log2', limits = c(-Inf, 2048),
breaks = c(0.25, 4, 64, 1024),
labels = c("0.25", "4", "64", "1024"))+
ylab('MIC resistance level') +
xlab('pooled assay resistance level')+
geom_smooth(method = "lm", se = FALSE, formula = y ~ x)+
stat_cor(method = "pearson", size = 2)+
scale_color_manual(values = c(red_Ec_color, blue_Kp_color, yellow_Se_color))+
guides(color = FALSE)
# assembly ####
p_width = 3
p_height = 3
gFig <- set_panel_size(Fig, width  = unit(p_width, "in"), height = unit(p_height, "in"))
save_plot("SI_Fig2.pdf", plot = gFig, base_width = 5, base_height = 5)
save_plot("SI_Fig2.pdf", plot = gFig, base_width = 4, base_height = 4)
